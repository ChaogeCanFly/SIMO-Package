\documentclass[12pt, a4paper, twoside]{memoir}
%\let\STARTCODE\relax
%\let\STOPCODE\relax
%\STARTCODE
\usepackage{color,calc,graphicx, soul}
\definecolor{nicered}{rgb}{.647,.129,.149}
\makeatletter
\newlength\dlf@normtxtw
\setlength\dlf@normtxtw{\textwidth}
\def\myhelvetfont{\def\sfdefault{mdput}}
\newsavebox{\feline@chapter}
\newcommand\feline@chapter@marker[1][4cm]{%
  \sbox\feline@chapter{%
    \resizebox{!}{#1}{\fboxsep=1pt%
      \colorbox{nicered}{\color{white}\bfseries\rmfamily\thechapter}%
    }}%
  \rotatebox{90}{%
    \resizebox{%
      \heightof{\usebox{\feline@chapter}}+\depthof{\usebox{\feline@chapter}}}%
    {!}{\scshape\so\@chapapp}}\quad%
  \raisebox{\depthof{\usebox{\feline@chapter}}}{\usebox{\feline@chapter}}%
}
\newcommand\feline@chm[1][4cm]{%
  \sbox\feline@chapter{\feline@chapter@marker[#1]}%
  \makebox[0pt][l]{% aka \rlap
    \makebox[1cm][r]{\usebox\feline@chapter}%
  }}
\makechapterstyle{daleif1}
    {
        %\renewcommand\chapnamefont{\normalfont\Large\scshape\raggedleft\so}
        \renewcommand\chaptitlefont{\normalfont\huge\bfseries\scshape\color{nicered}}
        \renewcommand\chapternamenum{}
        \renewcommand\printchaptername{}
        \renewcommand\printchapternum{\null\hfill\feline@chm[2.5cm]\par}
        \renewcommand\afterchapternum{\par\vskip\midchapskip}
        \renewcommand\printchaptertitle[1]{\chaptitlefont\raggedleft ##1\par}
    }
\makeatother
\chapterstyle{daleif1}
%\STOPCODE
\setlength\afterchapskip {\onelineskip }
\setlength\beforechapskip {\onelineskip }
\usepackage{lipsum}

\setlength{\parskip}{0.5\baselineskip}
\usepackage{savesym}
\usepackage[headsepline,footsepline]{scrlayer-scrpage}
%\usepackage{structuralanalysis}
\savesymbol{notation}
\usepackage[top=2cm,bottom=2cm,left=2cm,right=2cm,headsep=10pt]{geometry} % Page margins
\usepackage{etex}
% choose options for [] as required from the list
% in the Reference Guide
\usepackage{amsmath}
\setcounter{MaxMatrixCols}{20}
\usepackage{amsthm} % For including math equations, theorems, symbols, etc
\usepackage{amsfonts} % need for \mathbb
\usepackage{commath}
\usepackage[nomessages]{fp} %An extensive collection of arithmetic operations for fixed point real numbers of high precision.
\usepackage{mathrsfs}
\usepackage{mathtools}

%\usepackage[nomath, variablett]{lmodern}
\renewcommand{\rmdefault}{ptm}		% set Times as the default text font
\usepackage[subscriptcorrection]{mtpro2}
\raggedbottom %makes all pages the height of the text on that page. No extra vertical space is added.

\savesymbol{openbox}
\savesymbol{newfloat}
\usepackage{type1cm}
%\usepackage[Symbol]{upgreek}
\usepackage{makeidx}         % allows index generation
\usepackage{graphicx}        % standard LaTeX graphics tool
                             % when including figure files
\usepackage{multicol}        % used for the two-column index
\usepackage[bottom]{footmisc}% places footnotes at page bottom
\usepackage[T1]{fontenc}
\usepackage{textcomp}

\usepackage{float}%placing figures and table precisely
\usepackage[center, labelfont={it}, textfont={it}]{caption}%center: provides captions where each line is centered.
\usepackage{subcaption}

\usepackage{comment}
\pdfoptionpdfminorversion 7 %Use pdf version 1.6
%%settings for Tikz figures
%--------------------------------------------------------
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{pgfplots} % to use TikZ figures
%\usepackage{tikz-qtree}
\pgfplotsset{compat=newest}
%\pgfplotsset{plot coordinates/math parser=false}
%\usepackage{tikz,pgffor}
%\usepackage{tikz-3dplot}
\usetikzlibrary{calc}
\usetikzlibrary{spy}
%\newlength\figureheight
%\newlength\figurewidth
\usetikzlibrary{external}
\tikzexternalize[prefix=pdffigures/] % activate externalization!
\usepgfplotslibrary{patchplots}
\usetikzlibrary{quotes,angles}
\usetikzlibrary{decorations,decorations.markings,decorations.text,positioning, shadows, arrows, backgrounds, shapes, patterns, 3d, fit, bending}

\usepackage{siunitx}
\usepgflibrary{arrows.meta} % LATEX and plain TEX and pure pgf
\def\centerarc[#1](#2)(#3:#4:#5){ \draw[#1] ($(#2)+({#5*cos(#3)},{#5*sin(#3)})$) arc (#3:#4:#5); } %[draw options] (center) (initial angle:final angle:radius)

% Define the layers to draw the diagram
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

% Define the layers to draw the diagram
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

% Define block styles
\tikzstyle{materia}=[draw, fill=blue!20, text width=8.0em, text centered,
  minimum height=1.5em,drop shadow]
\tikzstyle{etape} = [materia, text width=20em, minimum width=10em,
  minimum height=3em, rounded corners, drop shadow]
\tikzstyle{texto} = [above, text width=6em, text centered]
\tikzstyle{linepart} = [draw, thick, color=black!50, dashed]
\tikzstyle{line} = [draw, thick, color=black!50, -latex']
\tikzstyle{ur}=[draw, text centered, minimum height=0.01em]

% Define distances for bordering
\newcommand{\blockdist}{1.3}
\newcommand{\edgedist}{1.5}

\newcommand{\etape}[2]{node (p#1) [etape]
  {#2}}

% Draw background
\newcommand{\background}[5]{%
  \begin{pgfonlayer}{background}
    % Left-top corner of the background rectangle
    \path (#1.west |- #2.north)+(-0.5,0.25) node (a1) {};
    % Right-bottom corner of the background rectanle
    \path (#3.east |- #4.south)+(+0.5,-0.25) node (a2) {};
    % Draw the background
    \path[fill=yellow!20,rounded corners, draw=black!50, dashed]
      (a1) rectangle (a2);
      \path (#3.east |- #2.north)+(0,0.25)--(#1.west |- #2.north) node[midway] (#5-n) {};
      \path (#3.east |- #2.south)+(0,-0.35)--(#1.west |- #2.south) node[midway] (#5-s) {};
      \path (#3.east |- #2.north)+(0.7,0)--(#3.east |- #4.south) node[midway] (#5-w) {};
  \end{pgfonlayer}}

\newcommand{\transreceptor}[3]{%
  \path [linepart] (#1.east) -- node [above]
    {#2} (#3);}
%--------------------------------------------------------

\usepackage{scalefnt} %used to scale fonts
\usepackage{IEEEtrantools}
\usepackage{array}%to center cell contents of a LaTeX table whose columns have fixed widths

%% setting for code listing
%----------------------------------------------------------------------------------
\usepackage[framed]{matlab-prettifier}
%\usepackage{fontspec}
\usepackage{lstautogobble}
\usepackage{inconsolata}
%\setmonofont{Consolas}
%\newfontfamily\Consolas{Consolas}
%\lstset{basicstyle=\Consolas}
%\usepackage{listings}
\lstset{
  style = Matlab-bw,
  basicstyle=\ttfamily\footnotesize,
  escapechar = `,
  mlcommentstyle = \color[RGB]{034,139,034},
  mlstringstyle = \color[RGB]{160,032,240},
  mlsyscomstyle = \color[RGB]{178,140,0},
  mlsectiontitlestyle = \color[gray]{0}\bfseries\itshape,
  mlsharedvarstyle = \color[gray]{0},
  %mlshowsectionrules = true,
  showspaces = false,
  columns=fullflexible,
  autogobble=true,
}

\newcounter{mainlisting}[chapter]
\newcounter{sublisting}[chapter]

%------------------------------------------------------------------------------------
% end of setting for code listing
\usepackage{hyperref}
\hypersetup{
    %bookmarks=true,         % show bookmarks bar?
    unicode=true,          % non-Latin characters in Acrobat’s bookmarks
    pdftoolbar=true,        % show Acrobat’s toolbar?
    pdfmenubar=true,        % show Acrobat’s menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={FitH},    % fits the width of the page to the window
    pdftitle={SIMO Package User Guide},    % title
    pdfauthor={Various Authors},     % author
    pdfsubject={Subject},   % subject of the document
    pdfcreator={Creator},   % creator of the document
    pdfproducer={Producer}, % producer of the document
    pdfkeywords={keyword1} {key2} {key3}, % list of keywords
    pdfnewwindow=true,      % links in new window
    colorlinks=true,       % false: boxed links; true: colored links
    %linkcolor=black,          % color of internal links (change box color with linkbordercolor)
%    citecolor=black,        % color of links to bibliography
%    filecolor=black,      % color of file links
%    urlcolor=black,           % color of external links
    pageanchor=false
}
\usepackage{bookmark}
\usepackage{multirow}
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\usepackage{longtable}
\usepackage{threeparttable}
%\usepackage{psfrag}
%\usepackage{cases}
%Separate bibliographies per chapter
%--------------------------------------------------
\usepackage[square,numbers,sectionbib]{natbib}
\usepackage{chapterbib}
\usepackage[toc, nonumberlist]{glossaries}
\makeglossaries

\begin{document}
\clearpage
%% temporary titles
% command to provide stretchy vertical space in proportion
\newcommand\nbvspace[1][3]{\vspace*{\stretch{#1}}}
% allow some slack to avoid under/overfull boxes
\newcommand\nbstretchyspace{\spaceskip0.5em plus 0.25em minus 0.25em}
% To improve spacing on titlepages
\newcommand{\nbtitlestretch}{\spaceskip0.6em}
\thispagestyle{empty}
\begin{center}
\bfseries
\large Authors\\
\nbvspace[5]
{\Huge
SIMO Package\\
User Manual}

\nbvspace[15]

\end{center}
\frontmatter%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\thispagestyle{plain}
\cleardoublepage

%\pdfbookmark{\contentsname}{toc}
\tableofcontents
\cleardoublepage

\mainmatter%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Term definitions
\newglossaryentry{meshbdry}{name=MeshBdry, description={Mesh of the Boundary}}
\newglossaryentry{nurbsbdry}{name=NURBSBdry, description={NURBS of the Boundary}}
\newglossaryentry{idx}{name=Idx, description={Index}}
\newglossaryentry{idcs}{name=Idcs, description={Indices}}
\newglossaryentry{vals}{name=Vals, description={Values}}
\newglossaryentry{bdryidcs}{name=BdryIdcs, description={Indices of boundary control points}}
\newglossaryentry{bdryvals}{name=BdryVals, description={Values of boundary control points}}
\newglossaryentry{drchlt}{name=Drchlt, description={Dirichlet}}
\newglossaryentry{neuman}{name=Neuman, description={Neumann}}
\newglossaryentry{kntvect}{name=KntVect, description={Knot Vector}}
\newglossaryentry{ctrlpts}{name=CtrlPts, description={Control Points}}
\newglossaryentry{curv}{name=Curv, description={Curve}}
\newglossaryentry{surf}{name=Surf, description={Surface}}
\newglossaryentry{volu}{name=Volu, description={Volume}}
\newglossaryentry{nsd}{name=NSD, description={Number of dimensional space}}
\newglossaryentry{uqkntvect}{name=uqKntVect, description={Unique knot values}}
\newglossaryentry{ctrlpts4d}{name=CtrlPts4D, description={Control point coordinates in homogeneous space}}
\newglossaryentry{ctrlpts3d}{name=CtrlPts3D, description={Control point coordinates in Cartesian space}}
\newglossaryentry{nctrlpts}{name=NCtrlPts, description={Number of control points}}
\newglossaryentry{nnp}{name=NNP, description={Number of total control points for a patch}}
\newglossaryentry{nel}{name=NEl, description={Number of elements}}
\newglossaryentry{nen}{name=NEN, description={Number of local basis functions}}
\newglossaryentry{dof}{name=Dof, description={Number of degree of freedom per control point}}
\newglossaryentry{el}{name=El, description={Element connectivity matrix}}
\newglossaryentry{neldir}{name=NElDir, description={Number of element in each direction}}
\newglossaryentry{ndof}{name=NDof, description={Number of degree of freedoms for a patch}}
\newglossaryentry{compdofs}{name=CompDofs, description={Degree of freedoms in components}}

%\clearpage
%\phantomsection
%Print the glossary
\glsaddall\printglossaries
%\addtocontents{toc}{test}

\include{./chapters/chapter1}
\include{./chapters/chapter2}
\include{./chapters/chapter3}
\include{./chapters/chapter4}
%\include{./chapters/chapter5}
%\include{./chapters/chapter6}
%\include{./chapters/chapter7}
\backmatter%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
